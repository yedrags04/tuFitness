/// <reference types="ws" />
import { WebSocket } from "@libsql/isomorphic-ws";
import type { ProtocolVersion } from "../client.js";
import { Client } from "../client.js";
import { Sql, SqlOwner, SqlState } from "../sql.js";
import type * as proto from "./proto.js";
import type { StreamState } from "./stream.js";
import { WsStream } from "./stream.js";
/** A client for the Hrana protocol over a WebSocket. */
export declare class WsClient extends Client implements SqlOwner {
    #private;
    /** @private */
    constructor(socket: WebSocket, jwt: string | null);
    /** Get the protocol version negotiated with the server, possibly waiting until the socket is open. */
    getVersion(): Promise<ProtocolVersion>;
    /** @private */
    _ensureVersion(minVersion: ProtocolVersion, feature: string): void;
    /** @private */
    _sendRequest(request: proto.Request, callbacks: ResponseCallbacks): void;
    /** Open a {@link WsStream}, a stream for executing SQL statements. */
    openStream(): WsStream;
    /** @private */
    _closeStream(streamState: StreamState, error: Error): void;
    /** @private */
    _sendStreamRequest(streamState: StreamState, request: proto.Request, callbacks: ResponseCallbacks): void;
    /** Cache a SQL text on the server. This requires protocol version 2 or higher. */
    storeSql(sql: string): Sql;
    /** @private */
    _closeSql(sqlState: SqlState, error: Error): void;
    /** Close the client and the WebSocket. */
    close(): void;
    /** True if the client is closed. */
    get closed(): boolean;
}
export interface OpenCallbacks {
    openCallback: () => void;
    errorCallback: (_: Error) => void;
}
export interface ResponseCallbacks {
    responseCallback: (_: proto.Response) => void;
    errorCallback: (_: Error) => void;
}
